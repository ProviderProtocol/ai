# v0.0.25 Changelog

## OpenRouter Reasoning Support

Full reasoning/extended thinking support for OpenRouter with both Chat Completions and Responses APIs.

### Chat Completions API

- [x] Added `reasoning_details` array parsing from responses
- [x] Support for `reasoning.text`, `reasoning.summary`, and `reasoning.encrypted` detail types
- [x] Streaming `ReasoningDelta` events from `reasoning_details` chunks
- [x] Multi-turn context preservation via `reasoning_details` forwarding in metadata
- [x] Filter reasoning blocks from message content (preserved via metadata)

```ts
const model = llm<OpenRouterCompletionsParams>({
  model: openrouter('anthropic/claude-sonnet-4'),
  params: {
    max_tokens: 4000,
    reasoning: {
      effort: 'high',
      max_tokens: 10000,
    },
  },
});
```

### Responses API

- [x] Added `OpenRouterResponsesReasoningOutput` type for reasoning output items
- [x] Added `OpenRouterResponsesReasoningInputItem` for multi-turn input
- [x] Streaming `response.reasoning.delta` event handling
- [x] `reasoningEncryptedContent` metadata for stateless multi-turn context
- [x] Summary text extraction to `ReasoningBlock` content

```ts
const model = llm<OpenRouterResponsesParams>({
  model: openrouter('openai/o3-mini'),
  params: {
    max_output_tokens: 4000,
    reasoning: {
      effort: 'medium',
    },
  },
});
```

### New Types

```ts
interface OpenRouterReasoningConfig {
  effort?: 'xhigh' | 'high' | 'medium' | 'low' | 'minimal' | 'none';
  max_tokens?: number;
  exclude?: boolean;
  enabled?: boolean;
}

type OpenRouterReasoningDetail =
  | OpenRouterReasoningSummary
  | OpenRouterReasoningText
  | OpenRouterReasoningEncrypted;

interface OpenRouterResponsesReasoningOutput {
  type: 'reasoning';
  id: string;
  summary: Array<{ type: 'summary_text'; text: string }>;
  encrypted_content?: string;
}
```

### Multi-Turn Context Preservation

OpenRouter reasoning context preserved automatically:

| API | Mechanism |
|-----|-----------|
| Completions | `reasoning_details` array forwarded via `metadata.openrouter.reasoning_details` |
| Responses | `reasoningEncryptedContent` (JSON with id, summary, encrypted_content) |

### Stream State Updates

- [x] Added `reasoning` and `reasoningDetails` fields to `CompletionsStreamState`
- [x] Added `reasoningByIndex` and `reasoningEncryptedContent` to `ResponsesStreamState`

## Tests

- [x] Extended `tests/live/reasoning.live.test.ts` with OpenRouter provider tests
- [x] Extended `tests/unit/providers/reasoning.test.ts` with unit tests
